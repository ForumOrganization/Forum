<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{HomeView.html :: head(${post.title})}"></div>
<script src="https://kit.fontawesome.com/30f218fe1f.js" crossorigin="anonymous"></script>


<body>
<div th:replace="~{HomeView.html :: header}"></div>

<div class="body-content">
    <h2 th:text="${post.getTitle()}">Post Title</h2>
    <div th:style="text-align">
        <p class="margin12" th:text="#{post.label.title}  + ': ' +       ${post.title}">Title</p>
        <p class="margin12" th:text="#{post.label.content} + ': ' +      ${post.content}">Content</p>
        <p class="margin12" th:text="#{post.label.createBy}  + ': ' + ${post.createdBy.username}">Created By</p>
        <p class="margin12" th:text="#{post.label.creation}  + ': ' + ${post.creationTime}">Creation Time</p>
    </div>
    <h3>
        <a th:if="${isAuthenticated}" href="#" th:href="@{__${requestURI}__/update}">Update</a>
        <a th:if="${isAuthenticated}" href="#" th:href="@{__${requestURI}__/delete}">Delete</a>
        <a th:if="${isAuthenticated}" th:href="@{/comments/new/posts/{postId}(postId=${postId})}">Create Comment</a>
    </h3>
</div>
<h3>Comments:</h3>
<div th:if="${comments}">
    <ul>
        <li th:each="comment : ${comments}">
            <p th:text="${comment.content}"></p>
            <p th:text="'Created By: ' + ${comment.user.username}"></p>
            <p th:text="'Creation Time: ' + ${comment.getCreationTime()}"></p>

<!--<h4>-->
<!--&lt;!&ndash;    <a th:if="${isAuthenticated}"  th:href="@{'/comments/'+${comment.id}+'/update/posts/'+${postId}}">Update</a>&ndash;&gt;-->
<!--    <a th:if="${isAuthenticated}"  th:href="@{'/comments/'+${comment.id}+'/update'}">Update</a>-->
<!--    <a th:if="${isAuthenticated}"  th:href="@{'/comments/'+${comment.id}+'/delete'}">Delete</a>-->

<!--    <a th:if="${isAuthenticated}" th:href="@{'/comments/'+${comment.id}+'/Like'}">-->
<!--        <i class="fa-regular fa-thumbs-up"></i>-->
<!--    </a>-->
<!--    <a th:if="${isAuthenticated}" th:href="@{'/comments/'+${comment.id}+'/DisLike'}">-->
<!--        <i class="fa-regular fa-thumbs-down"></i>-->
<!--    </a>-->
<!--</h4>-->
            <h4>
                <!-- Update and Delete links -->
                <a th:if="${isAuthenticated}" th:href="@{'/comments/'+${comment.id}+'/update'}">Update</a>
                <a th:if="${isAuthenticated}" th:href="@{'/comments/'+${comment.id}+'/delete'}">Delete</a>

                <!-- Like button with count -->
                <span id="likeButton">
        <a th:href="@{'/comments/'+${comment.id}+'/Like'}">
            <i class="fa-regular fa-thumbs-up"></i>
            <span id="likeCount">Loading...</span> <!-- Display like count here -->
        </a>
    </span>

                <!-- Dislike button with count -->
                <span id="dislikeButton">
        <a th:href="@{'/comments/'+${comment.id}+'/DisLike'}">
            <i class="fa-regular fa-thumbs-down"></i>
            <span id="dislikeCount">Loading...</span> <!-- Display dislike count here -->
        </a>
    </span>
            </h4>

            <script>
                // Fetch and display reaction counts
                $.get('/comments/${comment.id}/reaction-count', function(data) {
                    $('#likeCount').text(data.likeCount);
                    $('#dislikeCount').text(data.dislikeCount);
                })
                    .fail(function() {
                        $('#likeCount').text('Error fetching data');
                        $('#dislikeCount').text('Error fetching data');
                    });
            </script>

        </li>
    </ul>
</div>
<div th:if="${post.comments.isEmpty()}">
    <h2 th:text="#{comments.title.empty}">No comments yet.</h2>
</div>
<br/><br/>

<form th:replace="~{HomeView.html :: footer}"></form>
</body>
</html>